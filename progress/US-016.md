## 2026-01-11 22:30 - US-016

### Implemented CaptureController for component coordination

**What was implemented:**
- Created `CaptureController` class in `src/activity_beacon/daemon/capture_controller.py`
- Implemented `CaptureConfig` dataclass for configuration (output_directory, capture_interval_seconds, change_threshold, save_all_captures)
- Created comprehensive test suite with 36 tests in `tests/test_capture_controller.py`
- Added `CaptureController` and `CaptureConfig` exports to `src/activity_beacon/daemon/__init__.py`

**Files changed:**
- `src/activity_beacon/daemon/capture_controller.py` (created)
- `src/activity_beacon/daemon/__init__.py` (updated exports)
- `tests/test_capture_controller.py` (created)
- `prd.json` (marked US-016 as complete)

**Test results:**
- All 36 tests passing
- 92.98% code coverage for CaptureController module
- Ruff linting passes
- Basedpyright typecheck passes (existing module issues unrelated to this change)

**Key features:**
- Timer-based capture cycle with configurable intervals (default: 30 seconds)
- Change detection using ChangeDetector to skip unchanged screens (first capture always saved)
- Automatic pause/resume on screen lock via SystemStateMonitor integration
- Comprehensive callback system: on_start, on_stop, on_capture, on_pause, on_resume
- Proper error handling with last_error_msg property
- Thread-safe background capture loop with stop event
- Window data collection (focused app + all visible windows) and JSONL storage
- Organized file storage with date-based directory structure (YYYY/MM/DD)

**Design decisions:**
- Used frozen dataclass for configuration (CaptureConfig) for immutability
- Extracted `_invoke_capture_callbacks` to reduce nested block complexity (PLR1702)
- Made `_create_window_data_entry` and `_serialize_window_data_entry` static methods (PLR6301)
- Used keyword-only arguments to avoid boolean trap linting warnings
- Added noqa comments for intentionally unused parameters (jsonl_writer placeholder for future use)
